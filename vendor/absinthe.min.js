Absinthe={namespace:function(namespace,obj){var parts=namespace.split("."),root=typeof global!="undefined"?global:window,parent=root.Absinthe;for(var i=1,length=parts.length;i<length;i++)currentPart=parts[i],parent[currentPart]=parent[currentPart]||{},parent=parent[currentPart];return parent}},Absinthe.initialize=function(){if(!Absinthe.testBrowserSupport)return;var page=new Absinthe.Page({experiments:Absinthe.experiments}),cookie=Absinthe.config.cookie,visitorId=page.cookies.get(cookie.name),visitor=new Absinthe.Visitor(visitorId);page.cookies.set(cookie.name,visitor.id,cookie.length),page.experiments.forEach(function(e){var experiment=new Absinthe.Experiment(e);if(!experiment.isActive)return;if(!experiment.eligibilityTest(visitor))return;if(!experiment.eligibilityURLRegex.exec(window.location))return;var variation=experiment.assign(visitor);page.variations.push(variation)}),page.variations.forEach(function(variation){page.applyVariation(variation)}),Absinthe.page=page,Absinthe.visitor=visitor,page.recordAssignments()},Absinthe.testBrowserSupport=function(){if(!window.localStorage)return;if(!Array.prototype.forEach)return;return!0},Absinthe.recordEvent=function(eventName,data){data=data||{};var variationIds=Absinthe.page.variations.map(function(v){return v._id}),query=Absinthe.util.extend(data,{action:"record_event",eventName:eventName,variationId:variationIds,visitorId:Absinthe.visitor.id});Absinthe.request({path:"/api/events",query:query})},Absinthe.util={},Absinthe.util.queryString={stringify:function(obj){var params=[];for(var k in obj)obj[k]instanceof Array?obj[k].forEach(function(v){params.push({key:k,value:v})}):params.push({key:k,value:obj[k]});return params.map(function(p){return[p.key,encodeURIComponent(p.value)].join("=")}).join("&")}},Absinthe.util.extend=function(obj){return Array.prototype.slice.call(arguments,1).forEach(function(source){for(var prop in source)obj[prop]=source[prop]}),obj},Absinthe.request=function(options){var server=options.server||Absinthe.config.server,path=options.path,query=options.query;query.rand=Math.floor(Math.random()*1e5);var querystring=Absinthe.util.queryString.stringify(query),url=["http://"+server+path,querystring].join("?"),img=new Image;img.src=url},Absinthe.storage=function(){function supportsStorage(){var key="__lscachetest__",value=key;if(cachedStorage!==undefined)return cachedStorage;try{setItem(key,value),removeItem(key),cachedStorage=!0}catch(exc){cachedStorage=!1}return cachedStorage}function supportsJSON(){return cachedJSON===undefined&&(cachedJSON=window.JSON!=null),cachedJSON}function expirationKey(key){return key+CACHE_SUFFIX}function currentTime(){return Math.floor((new Date).getTime()/EXPIRY_UNITS)}function getItem(key){return localStorage.getItem(CACHE_PREFIX+cacheBucket+key)}function setItem(key,value){localStorage.removeItem(CACHE_PREFIX+cacheBucket+key),localStorage.setItem(CACHE_PREFIX+cacheBucket+key,value)}function removeItem(key){localStorage.removeItem(CACHE_PREFIX+cacheBucket+key)}var CACHE_PREFIX="Absinthe-",CACHE_SUFFIX="-cacheexpiration",EXPIRY_RADIX=10,EXPIRY_UNITS=6e4,MAX_DATE=Math.floor(864e13/EXPIRY_UNITS),cachedStorage,cachedJSON,cacheBucket="";return{set:function(key,value,time){if(!supportsStorage())return;if(typeof value!="string"){if(!supportsJSON())return;try{value=JSON.stringify(value)}catch(e){return}}try{setItem(key,value)}catch(e){if(e.name!=="QUOTA_EXCEEDED_ERR"&&e.name!=="NS_ERROR_DOM_QUOTA_REACHED")return;var storedKeys=[],storedKey;for(var i=0;i<localStorage.length;i++){storedKey=localStorage.key(i);if(storedKey.indexOf(CACHE_PREFIX+cacheBucket)===0&&storedKey.indexOf(CACHE_SUFFIX)<0){var mainKey=storedKey.substr((CACHE_PREFIX+cacheBucket).length),exprKey=expirationKey(mainKey),expiration=getItem(exprKey);expiration?expiration=parseInt(expiration,EXPIRY_RADIX):expiration=MAX_DATE,storedKeys.push({key:mainKey,size:(getItem(mainKey)||"").length,expiration:expiration})}}storedKeys.sort(function(a,b){return b.expiration-a.expiration});var targetSize=(value||"").length;while(storedKeys.length&&targetSize>0)storedKey=storedKeys.pop(),removeItem(storedKey.key),removeItem(expirationKey(storedKey.key)),targetSize-=storedKey.size;try{setItem(key,value)}catch(e){return}}time?setItem(expirationKey(key),(currentTime()+time).toString(EXPIRY_RADIX)):removeItem(expirationKey(key))},get:function(key){if(!supportsStorage())return null;var exprKey=expirationKey(key),expr=getItem(exprKey);if(expr){var expirationTime=parseInt(expr,EXPIRY_RADIX);if(currentTime()>=expirationTime)return removeItem(key),removeItem(exprKey),null}var value=getItem(key);if(!value||!supportsJSON())return value;try{return JSON.parse(value)}catch(e){return value}},remove:function(key){if(!supportsStorage())return null;removeItem(key),removeItem(expirationKey(key))},supported:function(){return supportsStorage()},flush:function(){if(!supportsStorage())return;for(var i=localStorage.length-1;i>=0;--i){var key=localStorage.key(i);key.indexOf(CACHE_PREFIX+cacheBucket)===0&&localStorage.removeItem(key)}},setBucket:function(bucket){cacheBucket=bucket},resetBucket:function(){cacheBucket=""}}}(),function(globalContext){function isFunction(object){return _toString.call(object)===FUNCTION_CLASS}function extend(destination,source){for(var property in source)source.hasOwnProperty(property)&&(destination[property]=source[property]);return destination}function keys(object){if(Type(object)!==OBJECT_TYPE)throw new TypeError;var results=[];for(var property in object)object.hasOwnProperty(property)&&results.push(property);return results}function Type(o){switch(o){case null:return NULL_TYPE;case void 0:return UNDEFINED_TYPE}var type=typeof o;switch(type){case"boolean":return BOOLEAN_TYPE;case"number":return NUMBER_TYPE;case"string":return STRING_TYPE}return OBJECT_TYPE}function isUndefined(object){return typeof object=="undefined"}function argumentNames(fn){var names=fn.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return names.length==1&&!names[0]?[]:names}function wrap(fn,wrapper){var __method=fn;return function(){var a=update([bind(__method,this)],arguments);return wrapper.apply(this,a)}}function update(array,args){var arrayLength=array.length,length=args.length;while(length--)array[arrayLength+length]=args[length];return array}function merge(array,args){return array=slice.call(array,0),update(array,args)}function bind(fn,context){if(arguments.length<2&&isUndefined(arguments[0]))return this;var __method=fn,args=slice.call(arguments,2);return function(){var a=merge(args,arguments);return __method.apply(context,a)}}var _toString=Object.prototype.toString,NULL_TYPE="Null",UNDEFINED_TYPE="Undefined",BOOLEAN_TYPE="Boolean",NUMBER_TYPE="Number",STRING_TYPE="String",OBJECT_TYPE="Object",FUNCTION_CLASS="[object Function]",slice=Array.prototype.slice,emptyFunction=function(){},Class=function(){function subclass(){}function create(){function klass(){this.initialize.apply(this,arguments)}var parent=null,properties=[].slice.apply(arguments);isFunction(properties[0])&&(parent=properties.shift()),extend(klass,Class.Methods),klass.superclass=parent,klass.subclasses=[];if(parent){subclass.prototype=parent.prototype,klass.prototype=new subclass;try{parent.subclasses.push(klass)}catch(e){}}for(var i=0,length=properties.length;i<length;i++)klass.addMethods(properties[i]);return klass.prototype.initialize||(klass.prototype.initialize=emptyFunction),klass.prototype.constructor=klass,klass}function addMethods(source){var ancestor=this.superclass&&this.superclass.prototype,properties=keys(source);IS_DONTENUM_BUGGY&&(source.toString!=Object.prototype.toString&&properties.push("toString"),source.valueOf!=Object.prototype.valueOf&&properties.push("valueOf"));for(var i=0,length=properties.length;i<length;i++){var property=properties[i],value=source[property];if(ancestor&&isFunction(value)&&argumentNames(value)[0]=="$super"){var method=value;value=wrap(function(m){return function(){return ancestor[m].apply(this,arguments)}}(property),method),value.valueOf=bind(method.valueOf,method),value.toString=bind(method.toString,method)}this.prototype[property]=value}return this}var IS_DONTENUM_BUGGY=function(){for(var p in{toString:1})if(p==="toString")return!1;return!0}();return{create:create,Methods:{addMethods:addMethods}}}();globalContext.exports?globalContext.exports.Class=Class:globalContext.Class=Class}(Absinthe),Absinthe.namespace("Absinthe.Experiment"),Absinthe.Experiment=Absinthe.Class.create({initialize:function(options){this.id=options._id,this.variations=options.variations,this.isActive=options.isActive!==undefined?options.isActive:!0,this.eligibilityURLRegex=new RegExp(options.eligibilityURLRegex),this.eligibilityTest=eval(options.eligibilityTest)||function(){return!0}},assign:function(visitor){var variation,ki=parseInt(Absinthe.md5([this.id,visitor.id].join(";")),16)%1e3,runningIndex=0;return this.variations.forEach(function(v){if(variation)return;ki/1e3<runningIndex+v.weight&&(variation=v),runningIndex+=v.weight}),variation}}),Absinthe.namespace("Absinthe.Visitor"),Absinthe.Visitor=Absinthe.Class.create({initialize:function(id){this.id=id||this.generateId()},generateId:function(){return Math.floor(Math.random()*(Math.pow(2,32)-1))},language:function(){return"en"},location:function(){}}),Absinthe.Page=Absinthe.Class.create({initialize:function(options){this.variations=options.variations||[],this.experiments=options.experiments||[]},applyVariation:function(variation){this._injectCSS(variation.css);if(!variation.javascript)return;var f=eval(variation.javascript);this._domReady(f)},_injectCSS:function(cssText){var head=document.getElementsByTagName("head")[0],style=document.createElement("style"),rules=document.createTextNode(cssText);style.type="text/css",style.styleSheet?style.styleSheet.cssText=rules.nodeValue:style.appendChild(rules),head.appendChild(style)},_domReady:function(fn){document.addEventListener("DOMContentLoaded",function(){fn()})},recordAssignments:function(){var experiments=Absinthe.storage.get("experiments")||{},assignedVariations=this.variations.filter(function(v){if(!experiments[v.experimentId])return!0;if(experiments[v.experimentId]!==v._id)return!0}),variationIds=assignedVariations.map(function(v){return v._id});if(!variationIds.length)return;var query={action:"record_assignment",variationId:variationIds,visitorId:Absinthe.visitor.id};Absinthe.request({path:"/api/assignments",query:query});var experiments=Absinthe.storage.get("experiments")||{};assignedVariations.forEach(function(v){experiments[v.experimentId]=v._id}),Absinthe.storage.set("experiments",experiments)},cookies:{set:function(name,value,seconds){if(seconds){var date=new Date;date.setTime(date.getTime()+seconds*1e3);var expires="; expires="+date.toGMTString()}else var expires="";document.cookie=name+"="+value+expires+"; path=/"},get:function(name){var nameEQ=name+"=",ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" ")c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length)}return null},erase:function(name){createCookie(name,"",-1)}}}),function(a){function b(a,b){var c=(a&65535)+(b&65535),d=(a>>16)+(b>>16)+(c>>16);return d<<16|c&65535}function c(a,b){return a<<b|a>>>32-b}function d(a,d,e,f,g,h){return b(c(b(b(d,a),b(f,h)),g),e)}function e(a,b,c,e,f,g,h){return d(b&c|~b&e,a,b,f,g,h)}function f(a,b,c,e,f,g,h){return d(b&e|c&~e,a,b,f,g,h)}function g(a,b,c,e,f,g,h){return d(b^c^e,a,b,f,g,h)}function h(a,b,c,e,f,g,h){return d(c^(b|~e),a,b,f,g,h)}function i(a,c){a[c>>5]|=128<<c%32,a[(c+64>>>9<<4)+14]=c;var d,i,j,k,l,m=1732584193,n=-271733879,o=-1732584194,p=271733878;for(d=0;d<a.length;d+=16)i=m,j=n,k=o,l=p,m=e(m,n,o,p,a[d],7,-680876936),p=e(p,m,n,o,a[d+1],12,-389564586),o=e(o,p,m,n,a[d+2],17,606105819),n=e(n,o,p,m,a[d+3],22,-1044525330),m=e(m,n,o,p,a[d+4],7,-176418897),p=e(p,m,n,o,a[d+5],12,1200080426),o=e(o,p,m,n,a[d+6],17,-1473231341),n=e(n,o,p,m,a[d+7],22,-45705983),m=e(m,n,o,p,a[d+8],7,1770035416),p=e(p,m,n,o,a[d+9],12,-1958414417),o=e(o,p,m,n,a[d+10],17,-42063),n=e(n,o,p,m,a[d+11],22,-1990404162),m=e(m,n,o,p,a[d+12],7,1804603682),p=e(p,m,n,o,a[d+13],12,-40341101),o=e(o,p,m,n,a[d+14],17,-1502002290),n=e(n,o,p,m,a[d+15],22,1236535329),m=f(m,n,o,p,a[d+1],5,-165796510),p=f(p,m,n,o,a[d+6],9,-1069501632),o=f(o,p,m,n,a[d+11],14,643717713),n=f(n,o,p,m,a[d],20,-373897302),m=f(m,n,o,p,a[d+5],5,-701558691),p=f(p,m,n,o,a[d+10],9,38016083),o=f(o,p,m,n,a[d+15],14,-660478335),n=f(n,o,p,m,a[d+4],20,-405537848),m=f(m,n,o,p,a[d+9],5,568446438),p=f(p,m,n,o,a[d+14],9,-1019803690),o=f(o,p,m,n,a[d+3],14,-187363961),n=f(n,o,p,m,a[d+8],20,1163531501),m=f(m,n,o,p,a[d+13],5,-1444681467),p=f(p,m,n,o,a[d+2],9,-51403784),o=f(o,p,m,n,a[d+7],14,1735328473),n=f(n,o,p,m,a[d+12],20,-1926607734),m=g(m,n,o,p,a[d+5],4,-378558),p=g(p,m,n,o,a[d+8],11,-2022574463),o=g(o,p,m,n,a[d+11],16,1839030562),n=g(n,o,p,m,a[d+14],23,-35309556),m=g(m,n,o,p,a[d+1],4,-1530992060),p=g(p,m,n,o,a[d+4],11,1272893353),o=g(o,p,m,n,a[d+7],16,-155497632),n=g(n,o,p,m,a[d+10],23,-1094730640),m=g(m,n,o,p,a[d+13],4,681279174),p=g(p,m,n,o,a[d],11,-358537222),o=g(o,p,m,n,a[d+3],16,-722521979),n=g(n,o,p,m,a[d+6],23,76029189),m=g(m,n,o,p,a[d+9],4,-640364487),p=g(p,m,n,o,a[d+12],11,-421815835),o=g(o,p,m,n,a[d+15],16,530742520),n=g(n,o,p,m,a[d+2],23,-995338651),m=h(m,n,o,p,a[d],6,-198630844),p=h(p,m,n,o,a[d+7],10,1126891415),o=h(o,p,m,n,a[d+14],15,-1416354905),n=h(n,o,p,m,a[d+5],21,-57434055),m=h(m,n,o,p,a[d+12],6,1700485571),p=h(p,m,n,o,a[d+3],10,-1894986606),o=h(o,p,m,n,a[d+10],15,-1051523),n=h(n,o,p,m,a[d+1],21,-2054922799),m=h(m,n,o,p,a[d+8],6,1873313359),p=h(p,m,n,o,a[d+15],10,-30611744),o=h(o,p,m,n,a[d+6],15,-1560198380),n=h(n,o,p,m,a[d+13],21,1309151649),m=h(m,n,o,p,a[d+4],6,-145523070),p=h(p,m,n,o,a[d+11],10,-1120210379),o=h(o,p,m,n,a[d+2],15,718787259),n=h(n,o,p,m,a[d+9],21,-343485551),m=b(m,i),n=b(n,j),o=b(o,k),p=b(p,l);return[m,n,o,p]}function j(a){var b,c="";for(b=0;b<a.length*32;b+=8)c+=String.fromCharCode(a[b>>5]>>>b%32&255);return c}function k(a){var b,c=[];c[(a.length>>2)-1]=undefined;for(b=0;b<c.length;b+=1)c[b]=0;for(b=0;b<a.length*8;b+=8)c[b>>5]|=(a.charCodeAt(b/8)&255)<<b%32;return c}function l(a){return j(i(k(a),a.length*8))}function m(a,b){var c,d=k(a),e=[],f=[],g;e[15]=f[15]=undefined,d.length>16&&(d=i(d,a.length*8));for(c=0;c<16;c+=1)e[c]=d[c]^909522486,f[c]=d[c]^1549556828;return g=i(e.concat(k(b)),512+b.length*8),j(i(f.concat(g),640))}function n(a){var b="0123456789abcdef",c="",d,e;for(e=0;e<a.length;e+=1)d=a.charCodeAt(e),c+=b.charAt(d>>>4&15)+b.charAt(d&15);return c}function o(a){return unescape(encodeURIComponent(a))}function p(a){return l(o(a))}function q(a){return n(p(a))}function r(a,b){return m(o(a),o(b))}function s(a,b){return n(r(a,b))}function t(a,b,c){return b?c?r(b,a):s(b,a):c?p(a):q(a)}"use strict",typeof define=="function"&&define.amd?define(function(){return t}):a.md5=t}(Absinthe);